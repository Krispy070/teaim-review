/* Comprehensive Print Styles */

/* Page margins and layout */
@page {
  margin: 0.5in 0.5in 1in 0.5in; /* top right bottom left - extra bottom space for footer */
  size: letter;
}

@media print {
  /* Print fundamentals */
  body { 
    -webkit-print-color-adjust: exact; 
    print-color-adjust: exact;
    background: white !important;
    color: #000 !important;
    font-size: 12pt;
    line-height: 1.4;
    margin: 0; /* Let @page handle margins */
    padding: 0; /* @page bottom margin handles footer spacing */
  }
  
  * { 
    color-adjust: exact !important;
    box-shadow: none !important;
  }

  /* Hide elements that don't belong in print */
  .hide-print,
  button:not(.print-keep),
  .hover\:opacity-100,
  [aria-hidden="true"],
  .tooltip,
  .dropdown-menu,
  nav:not(.print-keep),
  .sidebar:not(.print-keep),
  .floating-action,
  .modal,
  .dialog,
  .popover { 
    display: none !important; 
  }

  /* Enhanced page breaks with modern CSS */
  .page-break-before { 
    page-break-before: always; 
    break-before: page;
  }
  .page-break-after { 
    page-break-after: always; 
    break-after: page;
  }
  .page-break-inside { 
    page-break-inside: avoid;
    break-inside: avoid;
  }
  .page-break-avoid {
    page-break-inside: avoid;
    break-inside: avoid;
    orphans: 3;
    widows: 3;
  }
  
  /* Comprehensive page break avoidance */
  .card,
  .table-row,
  blockquote,
  pre,
  .kpi-card,
  .wellness-card,
  .stage-item,
  .guide-step,
  .comment-item,
  .action-item,
  .notification-item,
  .user-card,
  .project-summary,
  .analytics-widget,
  .sign-off-item,
  .digest-section,
  .stage-group { 
    page-break-inside: avoid;
    break-inside: avoid;
    orphans: 2;
    widows: 2;
  }

  /* Headings should stay with content */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    break-after: avoid;
    margin-top: 16pt;
    margin-bottom: 8pt;
    font-weight: bold;
  }
  
  h1 { font-size: 18pt; }
  h2 { font-size: 16pt; }
  h3 { font-size: 14pt; }
  h4, h5, h6 { font-size: 12pt; }

  /* Enhanced typography for PDF clarity */
  p { 
    margin: 6pt 0;
    orphans: 3;
    widows: 3;
    text-align: justify;
    hyphens: auto;
    -webkit-hyphens: auto;
    -ms-hyphens: auto;
  }
  
  /* Prevent awkward breaks */
  .text-nowrap,
  .whitespace-nowrap {
    white-space: nowrap !important;
  }

  /* Lists */
  ul, ol { margin: 8pt 0; }
  li { margin: 2pt 0; }

  /* Optimized links for print */
  a {
    color: #000 !important;
    text-decoration: underline;
    word-break: break-all;
  }
  /* Only show URLs for external links to avoid clutter */
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 9pt;
    color: #666;
    font-weight: normal;
  }
  /* Hide URL display for internal/relative links */
  a:not([href^="http"]):after {
    content: none;
  }

  /* Cards - make print friendly */
  .brand-card,
  .card,
  [class*="card"] { 
    border: 1pt solid #ddd !important;
    background: white !important;
    margin: 8pt 0 !important;
    padding: 12pt !important;
    box-shadow: none !important;
    border-radius: 0 !important;
  }

  /* Tables */
  table {
    border-collapse: collapse;
    width: 100%;
    margin: 12pt 0;
    page-break-inside: auto;
  }
  
  thead {
    display: table-header-group;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  tbody {
    display: table-row-group;
  }
  
  tr {
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  th, td {
    border: 1pt solid #ddd;
    padding: 6pt 8pt;
    text-align: left;
    vertical-align: top;
    font-size: 10pt;
    line-height: 1.3;
  }
  
  th {
    background: #f5f5f5 !important;
    font-weight: bold;
  }

  /* Dashboard and widget layouts */
  .dashboard-grid,
  .grid {
    display: block !important;
  }
  
  .grid > * {
    margin: 12pt 0 !important;
    width: 100% !important;
    float: none !important;
  }

  /* KPI Cards and metrics */
  .kpi-card,
  .metric-card,
  .analytics-card {
    display: inline-block;
    width: 48%;
    margin: 6pt 1% !important;
    vertical-align: top;
  }

  /* Timeline and stages */
  .timeline-item,
  .stage-item {
    border-left: 3pt solid #ddd;
    padding-left: 12pt;
    margin: 8pt 0;
  }

  /* Forms - compact for print */
  .form-group,
  .field-group {
    margin: 6pt 0;
  }
  
  input, textarea, select {
    border: 1pt solid #ccc !important;
    background: white !important;
    color: #000 !important;
    font-size: 10pt;
  }

  /* Badges and status indicators */
  .badge,
  .chip,
  .status-badge {
    background: #f0f0f0 !important;
    color: #000 !important;
    border: 1pt solid #ccc !important;
    padding: 2pt 6pt !important;
    border-radius: 0 !important;
    font-size: 9pt !important;
  }

  /* Enhanced chart and media handling - preserve essential SVGs */
  video, audio, iframe {
    display: none;
  }
  
  /* Hide complex interactive charts but preserve essential SVG icons/logos */
  [data-chart] svg,
  .recharts-wrapper svg,
  .chart-wrapper svg {
    display: none;
  }
  
  /* Show fallbacks for hidden charts */
  [data-chart] .print-fallback,
  .recharts-wrapper .print-fallback,
  .chart-container .print-fallback,
  .media-container .print-fallback {
    display: block !important;
    border: 1pt solid #ddd;
    padding: 12pt;
    margin: 8pt 0;
    background: #f9f9f9 !important;
    font-style: italic;
    text-align: center;
    font-size: 11pt;
  }
  
  /* Essential SVGs that should remain visible */
  .brand-logo svg,
  .icon svg,
  .print-essential svg,
  .logo svg,
  .qr-code svg,
  .signature svg {
    display: block !important;
  }
  
  /* QR codes and similar should be visible */
  .qr-code,
  .print-essential {
    display: block !important;
  }

  /* Tabs - show all content */
  .tabs-content > * {
    display: block !important;
  }
  .tabs-list {
    display: none !important;
  }

  /* Comments and activity feeds */
  .comment-item,
  .activity-item,
  .audit-item {
    border-bottom: 1pt solid #eee;
    padding: 8pt 0;
    margin: 4pt 0;
  }

  /* Branding elements */
  .rule-gradient { 
    opacity: 1 !important;
    background: #ddd !important;
  }
  
  .brand-header {
    border-bottom: 2pt solid #000;
    margin-bottom: 16pt;
    padding-bottom: 8pt;
  }

  /* Enhanced export and document structure */
  .export-header,
  .document-header,
  .report-title,
  .page-header {
    page-break-inside: avoid;
    break-inside: avoid;
    margin-bottom: 16pt;
  }
  
  .document-footer,
  .page-footer {
    page-break-inside: avoid;
    break-inside: avoid;
    margin-top: 16pt;
    border-top: 1pt solid #ddd;
    padding-top: 8pt;
  }
  
  /* Section separators */
  .section-break {
    page-break-before: always;
    break-before: page;
  }
  
  .section-divider {
    border-top: 2pt solid #000;
    margin: 16pt 0;
    page-break-after: avoid;
    break-after: avoid;
  }

  /* Critical: Enhanced viewport and layout reset for perfect printing */
  html, body, #root, 
  .app-shell, 
  .app-shell-main, 
  .app-shell-content,
  main,
  .main-content,
  .page-container,
  .content-wrapper {
    height: auto !important;
    min-height: 0 !important;
    max-height: none !important;
    overflow: visible !important;
    position: static !important;
    transform: none !important;
    will-change: auto !important;
  }
  
  /* Enhanced header and navigation for print */
  .app-shell-header,
  .header,
  .navbar,
  .top-bar {
    position: static !important;
    width: 100% !important;
    left: auto !important;
    right: auto !important;
    top: auto !important;
    z-index: auto !important;
    transform: none !important;
  }
  
  /* Hide sidebar in print (optional - can be kept if needed) */
  .app-shell-sidebar {
    display: none !important;
  }
  
  /* Enhanced viewport and layout fixes */
  .scroll-container,
  .overflow-scroll,
  .overflow-auto {
    overflow: visible !important;
    height: auto !important;
    max-height: none !important;
  }
  
  .fixed,
  .sticky {
    position: static !important;
  }
  
  /* Clean margins for better page utilization */
  .container,
  .max-w-7xl,
  .max-w-4xl {
    max-width: none !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
  
  /* Improve spacing consistency */
  .space-y-4 > * + *,
  .space-y-6 > * + *,
  .space-y-8 > * + * {
    margin-top: 8pt !important;
  }
  
  .gap-4,
  .gap-6,
  .gap-8 {
    gap: 8pt !important;
  }
}

/* Enhanced export header with print optimization */
.export-header {
  display: flex; align-items: center; justify-content: space-between;
  border-bottom: 2px solid var(--brand-color, #111111); 
  padding: 12px 0;
  margin-bottom: 20px;
  page-break-after: avoid;
  break-after: avoid;
}
.export-header .left, .export-header .right { 
  display: flex; 
  align-items: center; 
  gap: 12px;
}
.export-header .title { 
  font-family: Poppins, Inter, system-ui; 
  font-size: 20px; 
  font-weight: 700;
  color: var(--brand-color, #111111);
}
.export-header .subtitle {
  font-size: 14px;
  font-weight: 400;
  color: #666;
  margin-top: 4px;
}
.export-subtle { 
  font-size: 12px; 
  color: #666;
  font-weight: normal;
}

/* Print performance optimizations */
@media print {
  /* Reduce rendering complexity */
  * {
    background-attachment: local !important;
    transform: none !important;
    transition: none !important;
    animation: none !important;
  }
  
  /* Optimize text rendering */
  .text-rendering-optimize {
    text-rendering: optimizeSpeed !important;
    font-smooth: never !important;
    -webkit-font-smoothing: none !important;
    -moz-osx-font-smoothing: unset !important;
  }
  
  /* Clean table spacing */
  .table-print-clean {
    border-spacing: 0 !important;
    border-collapse: separate !important;
  }
  
  .table-print-clean th,
  .table-print-clean td {
    border-width: 1pt !important;
    border-style: solid !important;
    border-color: #ccc !important;
  }
  
  /* Memory optimization - hide heavy elements */
  .heavy-animation,
  .complex-shadow,
  .gradient-bg,
  .blur-effect {
    display: none !important;
  }
}